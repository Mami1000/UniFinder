<div class="category-questions-container">
  <h2 appMathJax>–í–æ–ø—Ä–æ—Å—ã –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∏: {{ categoryName }}</h2>

  <div *ngIf="loading" class="loading">–ó–∞–≥—Ä—É–∑–∫–∞ –≤–æ–ø—Ä–æ—Å–æ–≤‚Ä¶</div>
  <div *ngIf="error" class="error">{{ error }}</div>

  <div *ngIf="!loading && questions.length; else noQuestions" class="questions-grid">
    <div *ngFor="let q of questions" class="question-card">
      
      <!-- –ö–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π -->
      <div class="question-actions" *ngIf="isAdmin">
        <button (click)="editQuestion(q)" title="–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å" class="action-btn edit">‚úèÔ∏è</button>
        <button (click)="deleteQuestion(q.id!)" title="–£–¥–∞–ª–∏—Ç—å" class="action-btn delete">üóëÔ∏è</button>
      </div>

      <!-- –†–µ–∂–∏–º —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è -->
      <div *ngIf="editQuestionId === q.id; else showQuestion" class="edit-form">
        <label>
          <span>–¢–µ–∫—Å—Ç –≤–æ–ø—Ä–æ—Å–∞:</span>
          <input
            type="text"
            [(ngModel)]="editedQuestion.text"
            placeholder="–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –≤–æ–ø—Ä–æ—Å–∞"
            class="edit-input"
          />
        </label>

        <label>
          <span>–ë–∞–ª–ª—ã:</span>
          <input
            type="number"
            [(ngModel)]="editedQuestion.point"
            placeholder="–£–∫–∞–∂–∏—Ç–µ –±–∞–ª–ª—ã"
            class="edit-input"
          />
        </label>

        <label>
          <span>–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ:</span>
          <input
            type="file"
            (change)="onFileSelected($event)"
            class="edit-input edit-image-input"
            accept="image/png, image/jpeg, image/jpg, image/webp"
          />
        </label>

        <!-- –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä –Ω–æ–≤–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è -->
        <div *ngIf="editedImage && previewImageUrl" class="image-preview">
          <img [src]="previewImageUrl" alt="–ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä" />
        </div>

        <div class="edit-actions">
          <button (click)="saveEditedQuestion()" class="btn-save">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
          <button (click)="cancelEdit()" class="btn-cancel">‚ùå –û—Ç–º–µ–Ω–∞</button>
        </div>
      </div>

      <!-- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤–æ–ø—Ä–æ—Å–∞ -->
      <ng-template #showQuestion>
        <p class="question-text" appMathJax>
          <span class="label">–í–æ–ø—Ä–æ—Å:</span> {{ getQuestionParts(q.text)[0] }}
        </p>

        <!-- –í–∞—Ä–∏–∞–Ω—Ç—ã –æ—Ç–≤–µ—Ç–∞ -->
        <ul class="answer-options" *ngIf="getQuestionParts(q.text)[1].length > 0" appMathJax>
          <li *ngFor="let option of getQuestionParts(q.text)[1]" class="answer-option">
            {{ option }}
          </li>
        </ul>

        <!-- –ö–∞—Ä—Ç–∏–Ω–∫–∞ -->
        <div class="question-image-container" *ngIf="q.imageUrl">
          <img [src]="getFullImageUrl(q.imageUrl)" alt="–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤–æ–ø—Ä–æ—Å–∞" />
          <button
            *ngIf="isAdmin"
            (click)="deleteImage(q.id!)"
            class="btn-delete-image"
            title="–£–¥–∞–ª–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ"
          >
            ‚ùå –£–¥–∞–ª–∏—Ç—å —Ñ–æ—Ç–æ
          </button>
        </div>

        <!-- –ë–∞–ª–ª—ã -->
        <p class="question-item" *ngIf="q.point">
          <span class="label">–ë–∞–ª –∑–∞ –≤–æ–ø—Ä–æ—Å:</span> {{ q.point }}
        </p>
      </ng-template>
    </div>
  </div>

  <ng-template #noQuestions>
    <div class="no-questions">–ù–µ—Ç –≤–æ–ø—Ä–æ—Å–æ–≤ –¥–ª—è —ç—Ç–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏.</div>
  </ng-template>
</div>
